define(function(){function a(a){return""===e?a:(a=a.charAt(0).toUpperCase()+a.substr(1),e+a)}var b=Math,c=document,d=c.createElement("div").style,e=function(){for(var a,b="t,webkitT,MozT,msT,OT".split(","),c=0,e=b.length;e>c;c++)if(a=b[c]+"ransform",a in d)return b[c].substr(0,b[c].length-1);return!1}(),f=e?"-"+e.toLowerCase()+"-":"",g=a("transform"),h=a("transitionProperty"),i=a("transitionDuration"),j=a("transformOrigin"),k=a("transitionTimingFunction"),l=a("transitionDelay"),m=/android/gi.test(navigator.appVersion),n=/iphone|ipad/gi.test(navigator.appVersion),o=/hp-tablet/gi.test(navigator.appVersion),p=a("perspective")in d,q="ontouchstart"in window&&!o,r=e!==!1,s=a("transition")in d,t="onorientationchange"in window?"orientationchange":"resize",u=q?"touchstart":"mousedown",v=q?"touchmove":"mousemove",w=q?"touchend":"mouseup",x=q?"touchcancel":"mouseup",y=function(){if(e===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return a[e]}(),z=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),A=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),B=p?" translateZ(0)":"",C=function(a,b){var d,e=this;e.wrapper="object"==typeof a?a:c.getElementById(a),e.wrapper.style.overflow="hidden",e.scroller=e.wrapper.children[0],e.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:m,hideScrollbar:n,fadeScrollbar:n&&p,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onScrolling:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(d in b)e.options[d]=b[d];e.x=e.options.x,e.y=e.options.y,e.options.useTransform=r&&e.options.useTransform,e.options.hScrollbar=e.options.hScroll&&e.options.hScrollbar,e.options.vScrollbar=e.options.vScroll&&e.options.vScrollbar,e.options.zoom=e.options.useTransform&&e.options.zoom,e.options.useTransition=s&&e.options.useTransition,e.options.zoom&&m&&(B=""),e.scroller.style[h]=e.options.useTransform?f+"transform":"top left",e.scroller.style[i]="0",e.scroller.style[j]="0 0",e.options.useTransition&&(e.scroller.style[k]="cubic-bezier(0.33,0.66,0.66,1)"),e.options.useTransform?e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px)"+B:e.scroller.style.cssText+=";position:absolute;top:"+e.y+"px;left:"+e.x+"px",e.options.useTransition&&(e.options.fixedScrollbar=!0),e._bind(t,window),e._bind(u),q||"none"!=e.options.wheelAction&&(e._bind("DOMMouseScroll"),e._bind("mousewheel")),e.options.checkDOMChanges&&(e.checkDOMTime=setInterval(function(){e._checkDOMChanges()},500))};return C.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case u:if(!q&&0!==a.button)return;b._start(a);break;case v:b._move(a);break;case w:case x:b._end(a);break;case t:b._resize();break;case"DOMMouseScroll":case"mousewheel":b._wheel(a);break;case y:b._transitionEnd(a)}},_checkDOMChanges:function(){this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale||this.refresh()},_scrollbar:function(a){var d,e=this;return e[a+"Scrollbar"]?(e[a+"ScrollbarWrapper"]||(d=c.createElement("div"),e.options.scrollbarClass?d.className=e.options.scrollbarClass+a.toUpperCase():d.style.cssText="position:absolute;z-index:100;"+("h"==a?"height:7px;bottom:1px;left:2px;right:"+(e.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(e.hScrollbar?"7":"2")+"px;top:2px;right:1px"),d.style.cssText+=";pointer-events:none;"+f+"transition-property:opacity;"+f+"transition-duration:"+(e.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(e.options.hideScrollbar?"0":"1"),e.wrapper.appendChild(d),e[a+"ScrollbarWrapper"]=d,d=c.createElement("div"),e.options.scrollbarClass||(d.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+f+"background-clip:padding-box;"+f+"box-sizing:border-box;"+("h"==a?"height:100%":"width:100%")+";"+f+"border-radius:3px;border-radius:3px"),d.style.cssText+=";pointer-events:none;"+f+"transition-property:"+f+"transform;"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+f+"transition-duration:0;"+f+"transform: translate(0,0)"+B,e.options.useTransition&&(d.style.cssText+=";"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),e[a+"ScrollbarWrapper"].appendChild(d),e[a+"ScrollbarIndicator"]=d),"h"==a?(e.hScrollbarSize=e.hScrollbarWrapper.clientWidth,e.hScrollbarIndicatorSize=b.max(b.round(e.hScrollbarSize*e.hScrollbarSize/e.scrollerW),8),e.hScrollbarIndicator.style.width=e.hScrollbarIndicatorSize+"px",e.hScrollbarMaxScroll=e.hScrollbarSize-e.hScrollbarIndicatorSize,e.hScrollbarProp=e.hScrollbarMaxScroll/e.maxScrollX):(e.vScrollbarSize=e.vScrollbarWrapper.clientHeight,e.vScrollbarIndicatorSize=b.max(b.round(e.vScrollbarSize*e.vScrollbarSize/e.scrollerH),8),e.vScrollbarIndicator.style.height=e.vScrollbarIndicatorSize+"px",e.vScrollbarMaxScroll=e.vScrollbarSize-e.vScrollbarIndicatorSize,e.vScrollbarProp=e.vScrollbarMaxScroll/e.maxScrollY),void e._scrollbarPos(a,!0)):void(e[a+"ScrollbarWrapper"]&&(r&&(e[a+"ScrollbarIndicator"].style[g]=""),e[a+"ScrollbarWrapper"].parentNode.removeChild(e[a+"ScrollbarWrapper"]),e[a+"ScrollbarWrapper"]=null,e[a+"ScrollbarIndicator"]=null))},_resize:function(){var a=this;setTimeout(function(){a.refresh()},m?200:0)},_pos:function(a,c){this.zoomed||(a=this.hScroll?a:0,c=this.vScroll?c:0,this.options.useTransform?this.scroller.style[g]="translate("+a+"px,"+c+"px) scale("+this.scale+")"+B:(a=b.round(a),c=b.round(c),this.scroller.style.left=a+"px",this.scroller.style.top=c+"px"),this.x=a,this.y=c,this._scrollbarPos("h"),this._scrollbarPos("v"))},_scrollbarPos:function(a,c){var d,e=this,f="h"==a?e.x:e.y;e[a+"Scrollbar"]&&(f=e[a+"ScrollbarProp"]*f,0>f?(e.options.fixedScrollbar||(d=e[a+"ScrollbarIndicatorSize"]+b.round(3*f),8>d&&(d=8),e[a+"ScrollbarIndicator"].style["h"==a?"width":"height"]=d+"px"),f=0):f>e[a+"ScrollbarMaxScroll"]&&(e.options.fixedScrollbar?f=e[a+"ScrollbarMaxScroll"]:(d=e[a+"ScrollbarIndicatorSize"]-b.round(3*(f-e[a+"ScrollbarMaxScroll"])),8>d&&(d=8),e[a+"ScrollbarIndicator"].style["h"==a?"width":"height"]=d+"px",f=e[a+"ScrollbarMaxScroll"]+(e[a+"ScrollbarIndicatorSize"]-d))),e[a+"ScrollbarWrapper"].style[l]="0",e[a+"ScrollbarWrapper"].style.opacity=c&&e.options.hideScrollbar?"0":"1",e[a+"ScrollbarIndicator"].style[g]="translate("+("h"==a?f+"px,0)":"0,"+f+"px)")+B,e.options.onScrolling&&e.options.onScrolling.call(e))},_start:function(a){var c,d,e,f,h,i=this,j=q?a.touches[0]:a;i.enabled&&(i.options.onBeforeScrollStart&&i.options.onBeforeScrollStart.call(i,a),(i.options.useTransition||i.options.zoom)&&i._transitionTime(0),i.moved=!1,i.animating=!1,i.zoomed=!1,i.distX=0,i.distY=0,i.absDistX=0,i.absDistY=0,i.dirX=0,i.dirY=0,i.options.zoom&&q&&a.touches.length>1&&(f=b.abs(a.touches[0].pageX-a.touches[1].pageX),h=b.abs(a.touches[0].pageY-a.touches[1].pageY),i.touchesDistStart=b.sqrt(f*f+h*h),i.originX=b.abs(a.touches[0].pageX+a.touches[1].pageX-2*i.wrapperOffsetLeft)/2-i.x,i.originY=b.abs(a.touches[0].pageY+a.touches[1].pageY-2*i.wrapperOffsetTop)/2-i.y,i.options.onZoomStart&&i.options.onZoomStart.call(i,a)),i.options.momentum&&(i.options.useTransform?(c=getComputedStyle(i.scroller,null)[g].replace(/[^0-9\-.,]/g,"").split(","),d=+(c[12]||c[4]),e=+(c[13]||c[5])):(d=+getComputedStyle(i.scroller,null).left.replace(/[^0-9-]/g,""),e=+getComputedStyle(i.scroller,null).top.replace(/[^0-9-]/g,"")),d==i.x&&e==i.y||(i.options.useTransition?i._unbind(y):A(i.aniTime),i.steps=[],i._pos(d,e),i.options.onScrollEnd&&i.options.onScrollEnd.call(i))),i.absStartX=i.x,i.absStartY=i.y,i.startX=i.x,i.startY=i.y,i.pointX=j.pageX,i.pointY=j.pageY,i.startTime=a.timeStamp||Date.now(),i.options.onScrollStart&&i.options.onScrollStart.call(i,a),i._bind(v,window),i._bind(w,window),i._bind(x,window))},_move:function(a){var c,d,e,f=this,h=q?a.touches[0]:a,i=h.pageX-f.pointX,j=h.pageY-f.pointY,k=f.x+i,l=f.y+j,m=a.timeStamp||Date.now();return f.options.onBeforeScrollMove&&f.options.onBeforeScrollMove.call(f,a),f.options.zoom&&q&&a.touches.length>1?(c=b.abs(a.touches[0].pageX-a.touches[1].pageX),d=b.abs(a.touches[0].pageY-a.touches[1].pageY),f.touchesDist=b.sqrt(c*c+d*d),f.zoomed=!0,e=1/f.touchesDistStart*f.touchesDist*this.scale,e<f.options.zoomMin?e=.5*f.options.zoomMin*Math.pow(2,e/f.options.zoomMin):e>f.options.zoomMax&&(e=2*f.options.zoomMax*Math.pow(.5,f.options.zoomMax/e)),f.lastScale=e/this.scale,k=this.originX-this.originX*f.lastScale+this.x,l=this.originY-this.originY*f.lastScale+this.y,this.scroller.style[g]="translate("+k+"px,"+l+"px) scale("+e+")"+B,void(f.options.onZoom&&f.options.onZoom.call(f,a))):(f.pointX=h.pageX,f.pointY=h.pageY,(k>0||k<f.maxScrollX)&&(k=f.options.bounce?f.x+i/2:k>=0||f.maxScrollX>=0?0:f.maxScrollX),(l>f.minScrollY||l<f.maxScrollY)&&(l=f.options.bounce?f.y+j/2:l>=f.minScrollY||f.maxScrollY>=0?f.minScrollY:f.maxScrollY),f.distX+=i,f.distY+=j,f.absDistX=b.abs(f.distX),f.absDistY=b.abs(f.distY),void(f.absDistX<6&&f.absDistY<6||(f.options.lockDirection&&(f.absDistX>f.absDistY+5?(l=f.y,j=0):f.absDistY>f.absDistX+5&&(k=f.x,i=0)),f.moved=!0,f._pos(k,l),f.dirX=i>0?-1:0>i?1:0,f.dirY=j>0?-1:0>j?1:0,m-f.startTime>300&&(f.startTime=m,f.startX=f.x,f.startY=f.y),f.options.onScrollMove&&f.options.onScrollMove.call(f,a))))},_end:function(a){if(!q||0===a.touches.length){var d,e,f,h,j,k,l,m=this,n=q?a.changedTouches[0]:a,o={dist:0,time:0},p={dist:0,time:0},r=(a.timeStamp||Date.now())-m.startTime,s=m.x,t=m.y;if(m._unbind(v,window),m._unbind(w,window),m._unbind(x,window),m.options.onBeforeScrollEnd&&m.options.onBeforeScrollEnd.call(m,a),m.zoomed)return l=m.scale*m.lastScale,l=Math.max(m.options.zoomMin,l),l=Math.min(m.options.zoomMax,l),m.lastScale=l/m.scale,m.scale=l,m.x=m.originX-m.originX*m.lastScale+m.x,m.y=m.originY-m.originY*m.lastScale+m.y,m.scroller.style[i]="200ms",m.scroller.style[g]="translate("+m.x+"px,"+m.y+"px) scale("+m.scale+")"+B,m.zoomed=!1,m.refresh(),void(m.options.onZoomEnd&&m.options.onZoomEnd.call(m,a));if(!m.moved)return q&&(m.doubleTapTimer&&m.options.zoom?(clearTimeout(m.doubleTapTimer),m.doubleTapTimer=null,m.options.onZoomStart&&m.options.onZoomStart.call(m,a),m.zoom(m.pointX,m.pointY,1==m.scale?m.options.doubleTapZoom:1),m.options.onZoomEnd&&setTimeout(function(){m.options.onZoomEnd.call(m,a)},200)):this.options.handleClick&&(m.doubleTapTimer=setTimeout(function(){for(m.doubleTapTimer=null,d=n.target;1!=d.nodeType;)d=d.parentNode;"SELECT"!=d.tagName&&"INPUT"!=d.tagName&&"TEXTAREA"!=d.tagName&&(e=c.createEvent("MouseEvents"),e.initMouseEvent("click",!0,!0,a.view,1,n.screenX,n.screenY,n.clientX,n.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),e._fake=!0,d.dispatchEvent(e))},m.options.zoom?250:0))),m._resetPos(400),void(m.options.onTouchEnd&&m.options.onTouchEnd.call(m,a));if(300>r&&m.options.momentum&&(o=s?m._momentum(s-m.startX,r,-m.x,m.scrollerW-m.wrapperW+m.x,m.options.bounce?m.wrapperW:0):o,p=t?m._momentum(t-m.startY,r,-m.y,m.maxScrollY<0?m.scrollerH-m.wrapperH+m.y-m.minScrollY:0,m.options.bounce?m.wrapperH:0):p,s=m.x+o.dist,t=m.y+p.dist,(m.x>0&&s>0||m.x<m.maxScrollX&&s<m.maxScrollX)&&(o={dist:0,time:0}),(m.y>m.minScrollY&&t>m.minScrollY||m.y<m.maxScrollY&&t<m.maxScrollY)&&(p={dist:0,time:0})),o.dist||p.dist)return j=b.max(b.max(o.time,p.time),10),m.options.snap&&(f=s-m.absStartX,h=t-m.absStartY,b.abs(f)<m.options.snapThreshold&&b.abs(h)<m.options.snapThreshold?m.scrollTo(m.absStartX,m.absStartY,200):(k=m._snap(s,t),s=k.x,t=k.y,j=b.max(k.time,j))),m.scrollTo(b.round(s),b.round(t),j),void(m.options.onTouchEnd&&m.options.onTouchEnd.call(m,a));if(m.options.snap)return f=s-m.absStartX,h=t-m.absStartY,b.abs(f)<m.options.snapThreshold&&b.abs(h)<m.options.snapThreshold?m.scrollTo(m.absStartX,m.absStartY,200):(k=m._snap(m.x,m.y),k.x==m.x&&k.y==m.y||m.scrollTo(k.x,k.y,k.time)),void(m.options.onTouchEnd&&m.options.onTouchEnd.call(m,a));m._resetPos(400),m.options.onTouchEnd&&m.options.onTouchEnd.call(m,a)}},_resetPos:function(a){var b=this,c=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,d=b.y>=b.minScrollY||b.maxScrollY>0?b.minScrollY:b.y<b.maxScrollY?b.maxScrollY:b.y;return c==b.x&&d==b.y?(b.moved&&(b.moved=!1,b.options.onScrollEnd&&b.options.onScrollEnd.call(b)),b.hScrollbar&&b.options.hideScrollbar&&("webkit"==e&&(b.hScrollbarWrapper.style[l]="300ms"),b.hScrollbarWrapper.style.opacity="0"),void(b.vScrollbar&&b.options.hideScrollbar&&("webkit"==e&&(b.vScrollbarWrapper.style[l]="300ms"),b.vScrollbarWrapper.style.opacity="0"))):void b.scrollTo(c,d,a||0)},_wheel:function(a){var b,c,d,e,f,g=this;if("wheelDeltaX"in a)b=a.wheelDeltaX/12,c=a.wheelDeltaY/12;else if("wheelDelta"in a)b=c=a.wheelDelta/12;else{if(!("detail"in a))return;b=c=3*-a.detail}return"zoom"==g.options.wheelAction?(f=g.scale*Math.pow(2,1/3*(c?c/Math.abs(c):0)),f<g.options.zoomMin&&(f=g.options.zoomMin),f>g.options.zoomMax&&(f=g.options.zoomMax),void(f!=g.scale&&(!g.wheelZoomCount&&g.options.onZoomStart&&g.options.onZoomStart.call(g,a),g.wheelZoomCount++,g.zoom(a.pageX,a.pageY,f,400),setTimeout(function(){g.wheelZoomCount--,!g.wheelZoomCount&&g.options.onZoomEnd&&g.options.onZoomEnd.call(g,a)},400)))):(d=g.x+b,e=g.y+c,d>0?d=0:d<g.maxScrollX&&(d=g.maxScrollX),e>g.minScrollY?e=g.minScrollY:e<g.maxScrollY&&(e=g.maxScrollY),void(g.maxScrollY<0&&g.scrollTo(d,e,0)))},_transitionEnd:function(a){var b=this;a.target==b.scroller&&(b._unbind(y),b._startAni())},_startAni:function(){var a,c,d,e=this,f=e.x,g=e.y,h=Date.now();if(!e.animating){if(!e.steps.length)return void e._resetPos(400);if(a=e.steps.shift(),a.x==f&&a.y==g&&(a.time=0),e.animating=!0,e.moved=!0,e.options.useTransition)return e._transitionTime(a.time),e._pos(a.x,a.y),e.animating=!1,void(a.time?e._bind(y):e._resetPos(0));d=function(){var i,j,k=Date.now();return k>=h+a.time?(e._pos(a.x,a.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),void e._startAni()):(k=(k-h)/a.time-1,c=b.sqrt(1-k*k),i=(a.x-f)*c+f,j=(a.y-g)*c+g,e._pos(i,j),void(e.animating&&(e.aniTime=z(d))))},d()}},_transitionTime:function(a){a+="ms",this.scroller.style[i]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[i]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[i]=a)},_momentum:function(a,c,d,e,f){var g=6e-4,h=b.abs(a)/c,i=h*h/(2*g),j=0,k=0;return a>0&&i>d?(k=f/(6/(i/h*g)),d+=k,h=h*d/i,i=d):0>a&&i>e&&(k=f/(6/(i/h*g)),e+=k,h=h*e/i,i=e),i*=0>a?-1:1,j=h/g,{dist:i,time:b.round(j)}},_offset:function(a){for(var b=-a.offsetLeft,c=-a.offsetTop;a=a.offsetParent;)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(a,c){var d,e,f,g,h,i,j=this;for(f=j.pagesX.length-1,d=0,e=j.pagesX.length;e>d;d++)if(a>=j.pagesX[d]){f=d;break}for(f==j.currPageX&&f>0&&j.dirX<0&&f--,a=j.pagesX[f],h=b.abs(a-j.pagesX[j.currPageX]),h=h?b.abs(j.x-a)/h*500:0,j.currPageX=f,f=j.pagesY.length-1,d=0;f>d;d++)if(c>=j.pagesY[d]){f=d;break}return f==j.currPageY&&f>0&&j.dirY<0&&f--,c=j.pagesY[f],i=b.abs(c-j.pagesY[j.currPageY]),i=i?b.abs(j.y-c)/i*500:0,j.currPageY=f,g=b.round(b.max(h,i))||200,{x:a,y:c,time:g}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var a=this;a.scroller.style[g]="",a.hScrollbar=!1,a.vScrollbar=!1,a._scrollbar("h"),a._scrollbar("v"),a._unbind(t,window),a._unbind(u),a._unbind(v,window),a._unbind(w,window),a._unbind(x,window),a.options.hasTouch||(a._unbind("DOMMouseScroll"),a._unbind("mousewheel")),a.options.useTransition&&a._unbind(y),a.options.checkDOMChanges&&clearInterval(a.checkDOMTime),a.options.onDestroy&&a.options.onDestroy.call(a)},refresh:function(){var a,c,d,e,f=this,g=0,h=0;if(f.scale<f.options.zoomMin&&(f.scale=f.options.zoomMin),f.wrapperW=f.wrapper.clientWidth||1,f.wrapperH=f.wrapper.clientHeight||1,f.minScrollY=-f.options.topOffset||0,f.scrollerW=b.round(f.scroller.offsetWidth*f.scale),f.scrollerH=b.round((f.scroller.offsetHeight+f.minScrollY)*f.scale),f.maxScrollX=f.wrapperW-f.scrollerW,f.maxScrollY=f.wrapperH-f.scrollerH+f.minScrollY,f.dirX=0,f.dirY=0,f.options.onRefresh&&f.options.onRefresh.call(f),f.hScroll=f.options.hScroll&&f.maxScrollX<0,f.vScroll=f.options.vScroll&&(!f.options.bounceLock&&!f.hScroll||f.scrollerH>f.wrapperH),f.hScrollbar=f.hScroll&&f.options.hScrollbar,f.vScrollbar=f.vScroll&&f.options.vScrollbar&&f.scrollerH>f.wrapperH,a=f._offset(f.wrapper),f.wrapperOffsetLeft=-a.left,f.wrapperOffsetTop=-a.top,"string"==typeof f.options.snap)for(f.pagesX=[],f.pagesY=[],e=f.scroller.querySelectorAll(f.options.snap),c=0,d=e.length;d>c;c++)g=f._offset(e[c]),g.left+=f.wrapperOffsetLeft,g.top+=f.wrapperOffsetTop,f.pagesX[c]=g.left<f.maxScrollX?f.maxScrollX:g.left*f.scale,f.pagesY[c]=g.top<f.maxScrollY?f.maxScrollY:g.top*f.scale;else if(f.options.snap){for(f.pagesX=[];g>=f.maxScrollX;)f.pagesX[h]=g,g-=f.wrapperW,h++;for(f.maxScrollX%f.wrapperW&&(f.pagesX[f.pagesX.length]=f.maxScrollX-f.pagesX[f.pagesX.length-1]+f.pagesX[f.pagesX.length-1]),g=0,h=0,f.pagesY=[];g>=f.maxScrollY;)f.pagesY[h]=g,g-=f.wrapperH,h++;f.maxScrollY%f.wrapperH&&(f.pagesY[f.pagesY.length]=f.maxScrollY-f.pagesY[f.pagesY.length-1]+f.pagesY[f.pagesY.length-1])}f._scrollbar("h"),f._scrollbar("v"),f.zoomed||(f.scroller.style[i]="0",f._resetPos(400))},scrollTo:function(a,b,c,d){var e,f,g=this,h=a;for(g.stop(),h.length||(h=[{x:a,y:b,time:c,relative:d}]),e=0,f=h.length;f>e;e++)h[e].relative&&(h[e].x=g.x-h[e].x,h[e].y=g.y-h[e].y),g.steps.push({x:h[e].x,y:h[e].y,time:h[e].time||0});g._startAni()},scrollToElement:function(a,c){var d,e=this;a=a.nodeType?a:e.scroller.querySelector(a),a&&(d=e._offset(a),d.left+=e.wrapperOffsetLeft,d.top+=e.wrapperOffsetTop,d.left=d.left>0?0:d.left<e.maxScrollX?e.maxScrollX:d.left,d.top=d.top>e.minScrollY?e.minScrollY:d.top<e.maxScrollY?e.maxScrollY:d.top,c=void 0===c?b.max(2*b.abs(d.left),2*b.abs(d.top)):c,e.scrollTo(d.left,d.top,c))},scrollToPage:function(a,b,c){var d,e,f=this;c=void 0===c?400:c,f.options.onScrollStart&&f.options.onScrollStart.call(f),f.options.snap?(a="next"==a?f.currPageX+1:"prev"==a?f.currPageX-1:a,b="next"==b?f.currPageY+1:"prev"==b?f.currPageY-1:b,a=0>a?0:a>f.pagesX.length-1?f.pagesX.length-1:a,b=0>b?0:b>f.pagesY.length-1?f.pagesY.length-1:b,f.currPageX=a,f.currPageY=b,d=f.pagesX[a],e=f.pagesY[b]):(d=-f.wrapperW*a,e=-f.wrapperH*b,d<f.maxScrollX&&(d=f.maxScrollX),e<f.maxScrollY&&(e=f.maxScrollY)),f.scrollTo(d,e,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(v,window),this._unbind(w,window),this._unbind(x,window)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(y):A(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,b,c,d){var e=this,f=c/e.scale;e.options.useTransform&&(e.zoomed=!0,d=void 0===d?200:d,a=a-e.wrapperOffsetLeft-e.x,b=b-e.wrapperOffsetTop-e.y,e.x=a-a*f+e.x,e.y=b-b*f+e.y,e.scale=c,e.refresh(),e.x=e.x>0?0:e.x<e.maxScrollX?e.maxScrollX:e.x,e.y=e.y>e.minScrollY?e.minScrollY:e.y<e.maxScrollY?e.maxScrollY:e.y,e.scroller.style[i]=d+"ms",e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px) scale("+c+")"+B,e.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},d=null,"undefined"!=typeof exports?exports.iScroll=C:window.iScroll=C,C});